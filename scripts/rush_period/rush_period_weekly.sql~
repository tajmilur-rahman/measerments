\set ECHO all

\o /tmp/last_two_weeks_churns_weekly.rpt
select sum(add+remove) as churn from dp_commits p, git_commit c, git_revision r, stable_releases sr where c.commit = p.commit and p.commit=r.commit and p.release=sr.release and author_dt between (sr.stab_start_date-interval '14' day) and (sr.stab_start_date) group by sr.release, extract(year from author_dt), extract(week from author_dt);
\o

\o /tmp/first_four_weeks_churns_weekly.rpt
select sum(add+remove) as churn from dp_commits p, git_commit c, git_revision r, stable_releases sr where c.commit = p.commit and p.commit=r.commit and p.release=sr.release and author_dt between sr.start_date and (sr.stab_start_date-interval '14' day) group by sr.release, extract(year from author_dt), extract(week from author_dt);
\o

## in R you'll have to get the top 10% of data manually
dev <- read.table('/tmp/dev.in', header = T, sep = '|')
mw <- read.table('/tmp/mw.in', header = T, sep = '|')
quantile(mw$sum, .9)
mw <- mw[mw$sum >= 149214,]
quantile(mw$sum, .9)

quantile(dev$sum, .9)
dev <- dev[dev$sum >= 118351.1,]
summary(dev$sum)
summary(mw$sum)
wilcox(mw$sum,dev$sum)
wilcox.test(mw$sum,dev$sum)
ks.test(mw$sum,dev$sum)

